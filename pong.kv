#:kivy 2.0.0
<PongBall>:
    size: 60, 60
    canvas:
        Ellipse:
            pos: self.pos
            size: self.size
            source: 'salvagianni.png'

<PongPaddle>:
    size: 25, 200
    canvas:
        Rectangle:
            pos: self.pos
            size: self.size

<PongGame>:
    id: ponggame
    ball: pong_ball
    player1: player_left
    player2: player_right
    pbar1: progress_sx
    pbar2: progress_dx

    canvas:
        Rectangle:
            pos: self.center_x - 5, 0
            size: 10, self.height

    #Need to make a winner popup

    #Options Popup
    Popup:
        id: opt_popup
        title: "Opzioni"
        on_parent:
            if self.parent == ponggame: self.parent.remove_widget(self)
        size: 400,400
        size_hint: None, None

        ##The layout is needed here because the popup needs ONLY a widget inside it. So we cheat.
        GridLayout:
            cols: 2
            rows: 6

            ToggleButton:
                id: music
                text: 'Musica On/Off'
                size_hint_y: None
                height: 44
                state: "down"
                on_press:
                    root.toggle_music()

            Button:
                id: close
                text: "Indietro"
                size_hint_y: None
                height: 44
                on_release:
                    opt_popup.dismiss()

            ToggleButton:
                id: winbool
                text: "Vincere On/Off"




    #StartButton
    Button:
        center_x: root.width / 2
        center_y: root.height / 2 - 60
        top: root.top / 2
        text: "Avvio"
        size: (110, 40)
        background_color: "cyan"
        on_press: self.parent.serve_ball()
        on_release: self.parent.remove_widget(self)

    #Options button
    Button:
        id: optbutton
        center_x: root.width / 2
        center_y: root.height - 50
        size: 35, 35
        background_normal: 'gear.png'
        background_down: 'gearr.png'
        on_press:
            self.parent.set_pause()
            opt_popup.open()
        on_release:
            self.parent.set_unpause()

    ##Freeze Button SX
    Button:
        id: freeze_sx
        center_x: root.width / 8
        center_y: root.height / 12
        size: 35, 35
        background_normal: 'freeze.png'
        background_down: 'freezer.png'
        on_press:
            self.parent.freeze_ballSX()

    #Freeze SX Label
    Label:
        id: freeze_label_sx
        text: "6"
        font_size: 25
        center_x: root.width / 8
        center_y: root.height / 12
        color: "yellow"
        blod: True

    ##Freeze button DX
    Button:
        id: freeze_dx
        center_x: root.width - root.width / 8
        center_y: root.height - root.height / 12
        size: 35, 35
        background_normal: 'freeze.png'
        background_down: 'freezer.png'
        on_press:
            self.parent.freeze_ballDX()
        text: "5"
        font: 'Karantina_Regular'
        color: "purple"
        font_size:65
    Label:
        text: "Hi hello 5"
        font: 'Karantina_Regular'

    #Burst Button SX
    Button:
        id: burst_sx
        center_x: root.width / 5.4
        center_y: root.height / 12
        size: 35, 35
        background_normal: 'burst.png'
        background_down: 'burst.png'
        on_press:
            self.parent.burst_ballSX()


    #Burst Button DX
    Button:
        id: burst_dx
        text: "5"
        center_x: root.width - root.width / 5.4
        center_y: root.height - root.height / 12
        size: 35, 35
        background_normal: 'burst.png'
        background_down: 'burst.png'
        on_press:
            self.parent.burst_ballDX()

    #Burst DX Label
    Label:
        id: burst_label_dx
        text: "5"
        font_size: 25
        center_x: root.width - root.width / 5.4
        center_y: root.height - root.height / 12
        color: "cyan"
        blod: True


    Label:
        font_size: 70
        center_x: root.width / 4
        top: root.top - 50
        text: str(root.player1.score)
        color: 'lime'

    Label:
        font_size: 70
        center_x: root.width * 3 / 4
        top: root.top - 50
        text: str(root.player2.score)
        color: 'lime'

    PongBall:
        id: pong_ball
        center: self.parent.center

    PongPaddle:
        id: player_left
        x: root.x
        center_y: root.center_y

    PongPaddle:
        id: player_right
        x: root.width - self.width
        center_y: root.center_y

    ##Punti SX
    Label:
        id: points_sx
        text: "0"
        center_x: root.width / 20
        center_y: root.height - root.height + 35
        color: "purple"
        font_size: 45
        bold: True

    ##Punti DX
    Label:
        id: points_dx
        text: "0"
        center_x: root.width - root.width / 20
        center_y: root.height - 35
        color: "purple"
        font: "MS Gothic"
        font_size: 45
        bold: True

    ProgBar:
        id: progress_sx
    ProgBar:
        id: progress_dx

<ProgBar>:

    orientation: 'horizontal'

    # Creating thepg bar of specific value
    ProgressBar:
        value: 8
        min: 0
        max: 100
        ##center_x: root.width - root.width / 5.4 + 100
        ##center_y: root.height - root.height / 8
        pos_hint: {'x':.5, 'y':.5}
		size_hint_x: 3
	    size_hint_y: 5